<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="measurement-methodology">Measurement methodology</h1>
<p>To enable smartphone to use Multipath TCP, the device must have a Multipath TCP capable kernel.<br />However, today only few servers are Multipath TCP capable.<br />Moreover, it is difficult to collect both WiFi and cellular traces without cooperation from an ISP.<br />To overcome these issues, we set up a Multipath TCP SOCKS proxy and relayed the TCP traffic to it.<br />Details to achieve these objectives are shown in the following sections.</p>
<h2 id="installing-the-proxy">Installing the proxy</h2>
<p>We set up a machine with Debian Wheezy and applied Multipath TCP v0.89.5 (kernel available <a href="https://github.com/multipath-tcp/mptcp/releases/tag/v0.89.5">here</a>).<br />To run services like ShadowSocks on it, we rely on <a href="https://www.docker.com/">Docker</a>.<br />In particular, we set up a Dockerfile to build a ShadowSocks server <a href="https://github.com/MPTCP-smartphone-thesis/docker-shadowsocks-c">here</a>.<br />Relative to the default configuration provided in <code>config.json</code>, we advise you to set the listening port to a well-used one (like 443 or 80) to avoid firewall and other middlebox interferences.<br />To limit the overhead of SOCKS, you can also change the encryption method to the <code>table</code> one, which is the lowest one.<br />Notice that at the time of the writing, ShadowSocks does still not support IPv6, so you will collect only IPv4 traces.<br />Finally, to collect traces, you can launch <a href="http://www.tcpdump.org/">tcpdump</a>.</p>
<h2 id="multipath-tcp-on-smartphones">Multipath TCP on smartphones</h2>
<p>We conducted experiments on rooted Nexus 5 devices with version 3.4 of the Linux kernel.<br />To make them Multipath TCP capable, one needs to backport the wanted version of Multipath TCP to this kernel.<br />For the Nexus 5 running of Android AOSP 4.4.2, a <code>boot.img</code> of Multipath TCP version 0.86.7 is available <a href="https://github.com/gdetal/mptcp_nexus5/wiki">here</a>.<br />Once flashed, the device is able to start Multipath TCP connections.</p>
<p>However, smartphones with Android 4.4 assume that only one wireless interface is active at a time.<br />This means that when such a device switches from cellular interface to WiFi one, it automatically resets all existing TCP connections by using Android specific functions.<br />To overcome this issue, we installed <a href="https://github.com/MPTCP-smartphone-thesis/MultipathControl">a special Android application managing the utilization of the cellular and WiFi interfaces</a> that enables both interfaces simultaneously.<br />Notice that this application requires root.</p>
<p>To relay the TCP traffic to the SOCKS proxy, the <a href="https://github.com/shadowsocks/shadowsocks-android">ShadowSocks Android client</a> is installed on smartphones.<br />In our experiments, we relayed the DNS traffic over TCP, and thus to the SOCKS proxy.<br />To ensure that users will stay connected to the proxy even if their device reboots, the option &quot;Auto Connect&quot; can be checked.</p>
</body>
</html>
